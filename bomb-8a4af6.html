<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F10daba46-51b9-474a-9c22-1222e6e158b2%2FPMI74K6FO73MCR770JT.png?table=collection&amp;id=51a399fe-3ada-47de-a312-8e2ad5e56579">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>实验三bomb&nbsp;|&nbsp;这儿是什么地方</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="实验三bomb">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;💣&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F10daba46-51b9-474a-9c22-1222e6e158b2%2FPMI74K6FO73MCR770JT.png?table=collection&amp;id=51a399fe-3ada-47de-a312-8e2ad5e56579"></span>&nbsp;
      
      <span>SixGoogle</span>
    </div>
  </a>
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About me?</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>

  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;💣&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">实验三bomb</h1>
    
  </header>
  <article id="https://www.notion.so/8a4af641467743988320bdcf74beda28" class="PageRoot"><div id="https://www.notion.so/1bc5858202c147da9e81e05b2abef104" class="ColumnList"><div id="https://www.notion.so/b74be51dfab8427b977a32a53c79b9a3" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/b015612c0a5742f2a917544e6be68921" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对bomb进行分析，找到6个拆弹密码</span></span></p></div><div id="https://www.notion.so/d24a4b869b4b462bb8fec6ff7401f557" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">输错密码就会</span></span></p></div></div><div id="https://www.notion.so/4f4b8efab85c421c91ae66e956f10c53" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/27ab79f152e6415499f4070936d88cc0" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd7c3590c-a0de-44c7-9302-c3007374a4e6%2FUntitled.jpeg?width=60&amp;table=block&amp;id=27ab79f1-52e6-4154-99f4-070936d88cc0"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd7c3590c-a0de-44c7-9302-c3007374a4e6%2FUntitled.jpeg?width=60&amp;table=block&amp;id=27ab79f1-52e6-4154-99f4-070936d88cc0" style="width:60px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/89f0e3d913c549d3a1fdcfedbf65292c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F4b7f81f7-b8e5-4962-b422-34bf51d86a8c%2FUntitled.png?width=568&amp;table=block&amp;id=89f0e3d9-13c5-49d3-a1fd-cfedbf65292c"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F4b7f81f7-b8e5-4962-b422-34bf51d86a8c%2FUntitled.png?width=568&amp;table=block&amp;id=89f0e3d9-13c5-49d3-a1fd-cfedbf65292c" style="width:568px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3456d712c8a5424a968422858c58dd50" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/5d48475f0e3f48ab9a313115425a6a31" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在ubuntu14.05用objdump输出了两个反汇编文件，其实只有一个有用，bomb_dis.txt，不清楚bomb-quiet是干啥的</span></span></p></div><div id="https://www.notion.so/4bf73c4028234b7783555bbbf1057dc1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">实在是不想用虚拟机的GDB，在wsl上安装32位支持</span></span></p></div><h2 id="https://www.notion.so/0391104813704028bc24aa2b23b207bb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/0391104813704028bc24aa2b23b207bb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段一 比较</span></span></h2><div id="https://www.notion.so/3adcc491bb27471f864962a9cf712f19" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">查看阶段1的代码发现他调用了一个strings_not_equal
8048b62:	e8 7d 04 00 00       	call   8048fe4 &lt;strings_not_equal&gt;</span></span></p></div><div id="https://www.notion.so/bd891905bca143aea934b331359ce2bb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">查看这个函数，发现里面在做字符串比较，而且会先计算长度以及给出了字符串的地址（一共两个存在ebx和esi），输入一个单字符串测试，发现ebx的字符串长度为1，esi的字符串长度为39，可知第一个密码长度为39字节，首地址在0x804a1c4</span></span></p></div><div id="https://www.notion.so/a127a501fad44e22b757708492130daf" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9e0c2ef7-0af9-4396-af90-a419d01463b4%2FUntitled.png?width=442&amp;table=block&amp;id=a127a501-fad4-4e22-b757-708492130daf"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9e0c2ef7-0af9-4396-af90-a419d01463b4%2FUntitled.png?width=442&amp;table=block&amp;id=a127a501-fad4-4e22-b757-708492130daf" style="width:442px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/e1ecf769fb9c41aa952ead7e4c06ca8c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Ff2a8bdee-55e3-409f-b3c6-be6c7052944c%2FUntitled.png?width=533&amp;table=block&amp;id=e1ecf769-fb9c-41aa-952e-ad7e4c06ca8c"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Ff2a8bdee-55e3-409f-b3c6-be6c7052944c%2FUntitled.png?width=533&amp;table=block&amp;id=e1ecf769-fb9c-41aa-952e-ad7e4c06ca8c" style="width:533px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/38125205251549449a5ec9e575db2225" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Brownie, you are doing a heck of a job.</strong></em></span></span></p></div><div id="https://www.notion.so/d59da40787234034aff0010ce56c2667" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F2460f0f1-9c0c-4f42-a7db-bc3c9be05711%2FUntitled.png?width=389&amp;table=block&amp;id=d59da407-8723-4034-aff0-010ce56c2667"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F2460f0f1-9c0c-4f42-a7db-bc3c9be05711%2FUntitled.png?width=389&amp;table=block&amp;id=d59da407-8723-4034-aff0-010ce56c2667" style="width:389px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/b7c62c2ceefd4f62bfcb905ecbe7e08b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ac1ae0f32c74405eafa9cb568d7c5253" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">后知后觉好像知道了首地址的时候就可以x/s了，不需要去管长度</span></span></p></div><div id="https://www.notion.so/eb00ecd76c6e4d63bf12a7e1d41256fd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">也就是说其实
一找到phase_1，就发现0x804a1c4</span></span></p></div><div id="https://www.notion.so/b30614f18c7b45f4866326e446c34aea" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fca514e24-7db1-4d09-9231-7a856d5a3dee%2FUntitled.png?width=604.9884643554688&amp;table=block&amp;id=b30614f1-8c7b-45f4-8663-26e446c34aea"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fca514e24-7db1-4d09-9231-7a856d5a3dee%2FUntitled.png?width=604.9884643554688&amp;table=block&amp;id=b30614f1-8c7b-45f4-8663-26e446c34aea" style="width:604.9884643554688px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/2e6d731505f7468db3ff4d62205508c1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2e6d731505f7468db3ff4d62205508c1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段二 循环</span></span></h2><div id="https://www.notion.so/a76521bd4f3842eaad706b269372de47" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">分析phase_2，前面在加载字符串</span></span></p></div><div id="https://www.notion.so/ca21fc16f7e3422d917bfe96758c7b09" class="ColumnList"><div id="https://www.notion.so/df7ab44a47e041af86d04fc2ec764f99" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/f9352d02da43436598940f4d1bc1fe19" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通过read_six_numbers发现，将输入的字符串分割为6个数子存在数组中，调用sscanf</span></span></p></div></div><div id="https://www.notion.so/dcfc256bf4064888907317142a0befb2" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/f0ee309e46794a41bca8e83fcc8b0979" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F1bd1afe8-4255-49fb-b84b-444fc64ff8e3%2FUntitled.png?width=330.9953918457031&amp;table=block&amp;id=f0ee309e-4679-4a41-bca8-e83fcc8b0979"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F1bd1afe8-4255-49fb-b84b-444fc64ff8e3%2FUntitled.png?width=330.9953918457031&amp;table=block&amp;id=f0ee309e-4679-4a41-bca8-e83fcc8b0979" style="width:330.9953918457031px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/06b95056cf0a451bbbd587faaba4f3cf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">知道了输入格式，接下来看输入是什么</span></span></p></div><pre id="https://www.notion.so/454082b90a624875b986d99509cffc09" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token coord">08048b74 &lt;phase_2>:</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048b74:	56                   	push   %esi
</span><span class="token prefix unchanged"> </span><span class="token line">8048b75:	53                   	push   %ebx
</span><span class="token prefix unchanged"> </span><span class="token line">8048b76:	83 ec 34             	sub    $0x34,%esp
</span><span class="token prefix unchanged"> </span><span class="token line">8048b79:	8d 44 24 18          	lea    0x18(%esp),%eax 
</span><span class="token prefix unchanged"> </span><span class="token line">#将栈上esp+24的地址加载到eax寄存器,看起来是（目的数组）字符串地址
</span><span class="token prefix unchanged"> </span><span class="token line">8048b7d:	89 44 24 04          	mov    %eax,0x4(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048b81:	8b 44 24 40          	mov    0x40(%esp),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048b85:	89 04 24             	mov    %eax,(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048b88:	e8 9e 06 00 00       	call   804922b &lt;read_six_numbers>
</span><span class="token prefix unchanged"> </span><span class="token line">#获取字符串中的6个数
</span><span class="token prefix unchanged"> </span><span class="token line">8048b8d:	83 7c 24 18 01       	cmpl   $0x1,0x18(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048b92:	74 05                	je     8048b99 &lt;phase_2+0x25>
</span><span class="token prefix unchanged"> </span><span class="token line">#要求第一个输入是1，不然就爆炸
</span><span class="token prefix unchanged"> </span><span class="token line">8048b94:	e8 5d 05 00 00       	call   80490f6 &lt;explode_bomb>
</span><span class="token prefix unchanged"> </span><span class="token line">8048b99:	8d 5c 24 1c          	lea    0x1c(%esp),%ebx
</span><span class="token prefix unchanged"> </span><span class="token line">#将第二个元素地址给到ebx
</span><span class="token prefix unchanged"> </span><span class="token line">8048b9d:	8d 74 24 30          	lea    0x30(%esp),%esi
</span><span class="token prefix unchanged"> </span><span class="token line"> #将结束地址给到esi
</span><span class="token prefix unchanged"> </span><span class="token line">8048ba1:	8b 43 fc             	mov    -0x4(%ebx),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">#查看ebx的前一个元素值给到eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048ba4:	01 c0                	add    %eax,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048ba6:	39 03                	cmp    %eax,(%ebx)
</span><span class="token prefix unchanged"> </span><span class="token line">#eax加上自己（乘2）后与ebx比较
</span><span class="token prefix unchanged"> </span><span class="token line">8048ba8:	74 05                	je     8048baf &lt;phase_2+0x3b>
</span><span class="token prefix unchanged"> </span><span class="token line">8048baa:	e8 47 05 00 00       	call   80490f6 &lt;explode_bomb>
</span><span class="token prefix unchanged"> </span><span class="token line">#不相等就爆炸
</span><span class="token prefix unchanged"> </span><span class="token line">8048baf:	83 c3 04             	add    $0x4,%ebx
</span><span class="token prefix unchanged"> </span><span class="token line">8048bb2:	39 f3                	cmp    %esi,%ebx
</span><span class="token prefix unchanged"> </span><span class="token line">8048bb4:	75 eb                	jne    8048ba1 &lt;phase_2+0x2d>
</span><span class="token prefix unchanged"> </span><span class="token line">相等就让ebx指向下一个元素，没到最后一个元素时循环执行
</span><span class="token prefix unchanged"> </span><span class="token line">8048bb6:	83 c4 34             	add    $0x34,%esp
</span><span class="token prefix unchanged"> </span><span class="token line">8048bb9:	5b                   	pop    %ebx
</span><span class="token prefix unchanged"> </span><span class="token line">8048bba:	5e                   	pop    %esi
</span><span class="token prefix unchanged"> </span><span class="token line">8048bbb:	c3                   	ret    </span></span></span></span></span></code></pre><div id="https://www.notion.so/cccf5980764d4e86839e45547b999f56" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">说明是要第一个输入为1，后面输入的五个数要是前一个数的两倍，格式是</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%d %d %d %d %d %d</code></span></span></p></div><div id="https://www.notion.so/dc6e0fc9775045649452ef884301080b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">1 2 4 8 16 32</strong></em></span></span></p></div><h2 id="https://www.notion.so/4f973f82a9f54b4eb2667256cc51e0df" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/4f973f82a9f54b4eb2667256cc51e0df"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段三 条件</span></span></h2><div id="https://www.notion.so/ff804f2eddce4ef18fb9b2375d50c309" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">困，被参数的位置磨了半天，关于第一个数到底放在0x1c(%esp)还是0x18(%esp)，gdb调试后发现其实是0x18(%esp)，读代码后找到跳转表</span></span></p></div><div id="https://www.notion.so/3c8d1f2610094ad7b931c65122d35bcd" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9469f88a-81fe-4f5c-81b6-e521763f778a%2FUntitled.png?width=673&amp;table=block&amp;id=3c8d1f26-1009-4ad7-b931-c65122d35bcd"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2F9469f88a-81fe-4f5c-81b6-e521763f778a%2FUntitled.png?width=673&amp;table=block&amp;id=3c8d1f26-1009-4ad7-b931-c65122d35bcd" style="width:673px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/240756addfd243a6a4d96a2f73034943" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token coord">08048bbc &lt;phase_3>:</span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048bbc:	83 ec 2c             	sub    $0x2c,%esp
</span><span class="token prefix unchanged"> </span><span class="token line">8048bbf:	8d 44 24 1c          	lea    0x1c(%esp),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048bc3:	89 44 24 0c          	mov    %eax,0xc(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048bc7:	8d 44 24 18          	lea    0x18(%esp),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048bcb:	89 44 24 08          	mov    %eax,0x8(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048bcf:	c7 44 24 04 e3 a3 04 	movl   $0x804a3e3,0x4(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048bd6:	08 
</span><span class="token prefix unchanged"> </span><span class="token line">8048bd7:	8b 44 24 30          	mov    0x30(%esp),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048bdb:	89 04 24             	mov    %eax,(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048bde:	e8 8d fc ff ff       	call   8048870 &lt;__isoc99_sscanf@plt>
</span><span class="token prefix unchanged"> </span><span class="token line">#和过程二差不多，从字符串获取两个数，0x804a3e3是%d %d
</span><span class="token prefix unchanged"> </span><span class="token line">8048be3:	83 f8 01             	cmp    $0x1,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048be6:	7f 05                	jg     8048bed &lt;phase_3+0x31>
</span><span class="token prefix unchanged"> </span><span class="token line">8048be8:	e8 09 05 00 00       	call   80490f6 &lt;explode_bomb>
</span><span class="token prefix unchanged"> </span><span class="token line">#先检查一下输入的数字小于等于1就爆，eax存的是sscanf返回的提取到的数字的数目
</span><span class="token prefix unchanged"> </span><span class="token line">8048bed:	83 7c 24 18 07       	cmpl   $0x7,0x18(%esp)
</span><span class="token prefix unchanged"> </span><span class="token line">8048bf2:	77 3c                	ja     8048c30 &lt;phase_3+0x74>
</span><span class="token prefix unchanged"> </span><span class="token line">#然后检查输入的第一个数字如果大于就爆
</span><span class="token prefix unchanged"> </span><span class="token line">8048bf4:	8b 44 24 18          	mov    0x18(%esp),%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048bf8:	ff 24 85 20 a2 04 08 	jmp    *0x804a220(,%eax,4)
</span><span class="token prefix unchanged"> </span><span class="token line">#进入跳转表
</span><span class="token prefix unchanged"> </span><span class="token line">8048bff:	b8 65 00 00 00       	mov    $0x65,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c04:	eb 3b                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入0  101
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c06:	b8 93 01 00 00       	mov    $0x193,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c0b:	eb 34                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入2 403
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c0d:	b8 cb 01 00 00       	mov    $0x1cb,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c12:	eb 2d                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入3 459
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c14:	b8 df 00 00 00       	mov    $0xdf,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c19:	eb 26                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入4 223
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c1b:	b8 6d 02 00 00       	mov    $0x26d,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c20:	eb 1f                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入5 621
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c22:	b8 bd 00 00 00       	mov    $0xbd,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c27:	eb 18                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入6 189
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c29:	b8 66 02 00 00       	mov    $0x266,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c2e:	eb 11                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#输入7 614
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c30:	e8 c1 04 00 00       	call   80490f6 &lt;explode_bomb>
</span><span class="token prefix unchanged"> </span><span class="token line">8048c35:	b8 00 00 00 00       	mov    $0x0,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c3a:	eb 05                	jmp    8048c41 &lt;phase_3+0x85>
</span></span>#处理第一个数是不是大于1的部分
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c3c:	b8 02 03 00 00       	mov    $0x302,%eax
</span><span class="token prefix unchanged"> </span><span class="token line">8048c41:	3b 44 24 1c          	cmp    0x1c(%esp),%eax
</span></span>#输入1 770
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">8048c45:	74 05                	je     8048c4c &lt;phase_3+0x90>
</span><span class="token prefix unchanged"> </span><span class="token line">#如果eax与第二个输入不相等就爆
</span><span class="token prefix unchanged"> </span><span class="token line">8048c47:	e8 aa 04 00 00       	call   80490f6 &lt;explode_bomb>
</span><span class="token prefix unchanged"> </span><span class="token line">8048c4c:	83 c4 2c             	add    $0x2c,%esp
</span><span class="token prefix unchanged"> </span><span class="token line">8048c4f:	c3                   	ret    </span></span></span></span></span></code></pre><div id="https://www.notion.so/66cf91fb2bdb49d68344636f9cf0cf43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">0  101； 1 770； 2 403； 3 459； 4 223； 5 621； 6 189； 7 614；</strong></em></span></span></p></div><h2 id="https://www.notion.so/fa0d0073c3c84e48bfab45b522df2f59" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/fa0d0073c3c84e48bfab45b522df2f59"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段四</span></span></h2><div id="https://www.notion.so/f98d8cae925f4ceb96fa80ce6a874da7" class="ColumnList"><div id="https://www.notion.so/5d9de020e9ef4c4f9aae1408c55fe47d" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/f316f3a7cea14064ac39397dfdf68f01" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">老套路发现输入的是%d %d</span></span></p></div></div><div id="https://www.notion.so/ee13e81e0cf84fbba39ef0bbc0145138" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/f5389fb5061a4a098b4f7befd68b05cf" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd8baa225-e91c-4afe-a278-cf4a4d0bd0f5%2FUntitled.png?width=215.92593383789062&amp;table=block&amp;id=f5389fb5-061a-4a09-8b4f-7befd68b05cf"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fdd719a06-a4c3-47e4-9b49-3a2adc703adc%2Fd8baa225-e91c-4afe-a278-cf4a4d0bd0f5%2FUntitled.png?width=215.92593383789062&amp;table=block&amp;id=f5389fb5-061a-4a09-8b4f-7befd68b05cf" style="width:215.92593383789062px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/3a6890b95a5e41fc867bf2ad555f4925" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">主体有有个func4，得看它在干撒</span></span></p></div><div id="https://www.notion.so/c421fe03e0ed4f4b9c80d0e699435982" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/8e907baa5bd54c73868b09f15f30da4c" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8e907baa5bd54c73868b09f15f30da4c"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段五</span></span></h2><div id="https://www.notion.so/ea5da7ee3bef41f59f0497363293c7fc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/1811befb074140d385a6a554fde3065d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1811befb074140d385a6a554fde3065d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段六</span></span></h2><div id="https://www.notion.so/ecfdb30c2a3245a89faed32455aec9c0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/339cc42ab0234617841ed67966998f1d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/339cc42ab0234617841ed67966998f1d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">阶段Egg</span></span></h2><div id="https://www.notion.so/807ef32ab85c4ce88ed1e8f486f05d1a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f29493187ec145449488cc6b8641d561" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/abaebbe34d8e41cd88208745a4e913d6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; 这儿是什么地方 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>